<div [ngClass]="themeClass" class="min-h-screen p-4 flex flex-col items-center gap-4 transition-colors duration-300">

      <!-- Header / Ad banner -->
      <header class="w-full max-w-3xl flex flex-col sm:flex-row items-center justify-between gap-3">
        <img [src]="imageUrlPrefix+'/icons/icon-72x72.png'" alt="Chess Timekeeper">
        <div class="ad-banner w-full sm:w-64 h-16 flex items-center justify-center rounded shadow-inner overflow-hidden">
          <!-- placeholder ad banner -->
          <div class="w-full h-full flex items-center justify-center bg-gradient-to-r from-slate-100/20 to-transparent">
            <!-- <small class="text-xs sm:text-sm">Ad banner placeholder</small> -->
          </div>
        </div>
      </header>

      <!-- Controls -->
      <section class="w-full max-w-3xl grid grid-cols-1 sm:grid-cols-2 gap-4">
        <div class="controls p-4 rounded-lg shadow-sm bg-opacity-40 backdrop-blur-md flex flex-col gap-3">
          <label class="text-sm">Select total game time</label>
          <div class="flex gap-2 flex-wrap">
            <button *ngFor="let opt of timeOptions" pButton type="button" (click)="selectOption(opt)"
                    [class.p-button-secondary]="selectedOption === opt.value"
                    class="px-3 py-1 rounded">{{opt.label}}</button>
          </div>

          <div class="flex gap-2 items-center mt-2">
            <input type="number" min="1" [(ngModel)]="customInput" class="input min-w-[90px] p-2 rounded border" placeholder="Custom minutes"/>
            <button pButton type="button" (click)="setCustomTime()" class="px-3 py-1 rounded">Set custom</button>
            <label class="flex items-center gap-2 ml-auto">
              <input type="checkbox" [(ngModel)]="treatAsHours" /> Treat as hours
            </label>
          </div>

          <div class="flex gap-2 items-center mt-2">
            <label class="flex items-center gap-2">
              <input type="checkbox" [(ngModel)]="soundOn" /> Sound on time's up
            </label>

            <label class="flex items-center gap-2 ml-auto">
              Theme:
              <select [(ngModel)]="theme" (change)="applyTheme()" class="ml-2 p-1 rounded">
                <option *ngFor="let t of themes" [value]="t">{{t}}</option>
              </select>
            </label>
          </div>

          <div class="flex gap-2 mt-3 justify-between">
            <button pButton type="button" (click)="reset()" class="px-3 py-1 rounded">Reset (R)</button>
            <button pButton type="button" (click)="togglePause()" class="px-3 py-1 rounded">{{paused ? 'Resume (P)' : 'Pause (P)'}} </button>
          </div>

          <div class="text-xs text-muted mt-2">Keyboard: Space = switch turn, R = reset, P = pause/resume</div>
        </div>

        <!-- Settings / status -->
        <div class="settings p-4 rounded-lg shadow-sm bg-opacity-40 backdrop-blur-md flex flex-col gap-3">
          <div class="flex items-center justify-between">
            <div>Total: <strong>{{formatSeconds(totalSeconds)}}</strong></div>
            <div>Each: <strong>{{formatSeconds(eachSeconds)}}</strong></div>
          </div>
          <div class="flex gap-2 mt-2">
            <button pButton type="button" (click)="startManual()" class="px-3 py-1 rounded">Start</button>
            <button pButton type="button" (click)="savePreferences()" class="px-3 py-1 rounded">Save prefs</button>
          </div>

          <div *ngIf="timeUpFor !== null" class="mt-3 p-2 rounded text-center font-bold text-red-700">Time's Up! — Player {{timeUpFor === 0 ? 'A' : 'B'}}</div>

          <div class="mt-2 text-sm text-muted">Theme and time are saved in localStorage and restored on load.</div>
        </div>
      </section>

      <!-- Clocks -->
      <main class="w-full max-w-3xl grid grid-cols-1 sm:grid-cols-2 gap-4">
        <div [ngClass]="{'active-player': activePlayer===0}" class="player p-6 rounded-lg shadow-lg flex flex-col items-center gap-4 transition-all duration-300">
          <div class="player-title text-sm uppercase">Player A</div>
          <div class="timer text-6xl sm:text-8xl font-mono tracking-wider">{{formatSeconds(times[0])}}</div>
          <div class="flex gap-2 w-full justify-center">
            <button pButton type="button" (click)="pressButton(0)" class="px-6 py-2 rounded">{{activePlayer===0 && running ? 'End Turn' : 'Start / Tap'}}</button>
            <button pButton type="button" (click)="addIncrement(0, 5)" class="px-3 py-1 rounded">+5s</button>
          </div>
        </div>

        <div [ngClass]="{'active-player': activePlayer===1}" class="player p-6 rounded-lg shadow-lg flex flex-col items-center gap-4 transition-all duration-300">
          <div class="player-title text-sm uppercase">Player B</div>
          <div class="timer text-6xl sm:text-8xl font-mono tracking-wider">{{formatSeconds(times[1])}}</div>
          <div class="flex gap-2 w-full justify-center">
            <button pButton type="button" (click)="pressButton(1)" class="px-6 py-2 rounded">{{activePlayer===1 && running ? 'End Turn' : 'Start / Tap'}}</button>
            <button pButton type="button" (click)="addIncrement(1, 5)" class="px-3 py-1 rounded">+5s</button>
          </div>
        </div>
      </main>

      <footer class="w-full max-w-3xl mt-4 text-center text-xs text-muted">Built with PrimeNG, Tailwind 4 & custom CSS — minimal design and smooth transitions.</footer>

      <!-- Hidden audio element for time's up -->
      <audio #alarmAudio>
        <source src="data:audio/wav;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEAESsAACJWAAACABAAZGF0YQAAAAA=" />
      </audio>

    </div>  