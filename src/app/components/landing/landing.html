

  <!-- Controls and Settings Row -->
  <section class="w-full max-w-3xl grid grid-cols-1 sm:grid-cols-2 gap-6 mt-4">
    <!-- Controls Card -->
    <div class="controls p-6 rounded-2xl shadow-lg bg-slate-50/80 backdrop-blur-lg border border-gray-100 flex flex-col gap-5">
      <label class="text-base font-medium text-gray-800 mb-2">Select Total Game Time</label>
      <div class="flex gap-2 flex-wrap">
        <button
          *ngFor="let opt of timeOptions"
          pButton
          type="button"
          (click)="selectOption(opt)"
          [class.p-button-outlined]="selectedOption === opt.value"
          class="px-4 py-2 rounded-lg transition">{{opt.label}}</button>
      </div>

      <div class="flex gap-2 items-center">
        <input type="number" min="1" [(ngModel)]="customInput"
               class="input w-24 p-2 rounded-lg border border-gray-300" placeholder="Custom min/hours"/>
        <button pButton type="button" (click)="setCustomTime()" icon="pi pi-check" class="rounded-lg"></button>
        <label class="flex items-center gap-2 ml-auto text-gray-600">
          <p-checkbox [(ngModel)]="treatAsHours" binary="true"></p-checkbox> <span>Treat as hours</span>
        </label>
      </div>

      <div class="flex gap-4 items-center">
        <label class="flex items-center gap-2 text-gray-600">
          <p-checkbox [(ngModel)]="soundOn" binary="true"></p-checkbox>
          <span>Sound alert on time's up</span>
        </label>
        <span class="ml-auto flex items-center gap-2">
          <i class="pi pi-palette text-pink-500"></i>
          <select [(ngModel)]="theme" (change)="applyTheme()" class="p-2 rounded-lg border">
            <option *ngFor="let t of themes" [value]="t">{{t | titlecase}}</option>
          </select>
        </span>
      </div>

      <div class="flex gap-3 mt-3 justify-between">
        <button pButton type="button" (click)="reset()" icon="pi pi-refresh" class="rounded-lg">Reset (R)</button>
        <button pButton type="button" (click)="togglePause()" [icon]="paused ? 'pi pi-play' : 'pi pi-pause'" class="rounded-lg">
          {{paused ? 'Resume (P)' : 'Pause (P)'}}
        </button>
      </div>
      <small class="text-slate-500 mt-2">Keyboard: <kbd class="px-2 bg-slate-200 rounded">Space</kbd> = Switch turn, <kbd class="px-2 bg-slate-200 rounded">R</kbd> = Reset, <kbd class="px-2 bg-slate-200 rounded">P</kbd> = Pause/Resume</small>
    </div>

    <!-- Settings & Status Card -->
    <div class="settings p-6 rounded-2xl shadow-lg bg-slate-50/80 backdrop-blur-lg border border-gray-100 flex flex-col gap-5">
      <div class="flex items-center justify-between text-lg font-semibold">
        <div>Total: <span class="font-bold text-goldAccent">{{formatSeconds(totalSeconds)}}</span></div>
        <div>Each: <span class="font-bold text-pink-700">{{formatSeconds(eachSeconds)}}</span></div>
      </div>
      <div class="flex gap-4 mt-2">
        <button pButton type="button" icon="pi pi-play" (click)="startManual()" class="rounded-lg">Start</button>
        <button pButton type="button" icon="pi pi-save" (click)="savePreferences()" class="rounded-lg">Save Prefs</button>
      </div>

      <div *ngIf="timeUpFor !== null" class="mt-3 p-3 rounded-lg text-center font-bold text-white bg-gradient-to-r from-pink-600 to-red-500 shadow-lg animate-pulse">
        <i class="pi pi-exclamation-triangle mr-2"></i>Time's Up! â€” Player {{timeUpFor === 0 ? 'A' : 'B'}}
      </div>
      <div class="mt-2 text-sm text-gray-500">Preferences are auto-saved and restored on load.</div>
    </div>
  </section>

  <!-- Clocks Panel -->
  <main class="w-full max-w-3xl grid grid-cols-1 sm:grid-cols-2 gap-6 mt-2">
    <!-- Player A -->
    <div [ngClass]="{'ring-4 ring-pink-500 ring-offset-2 active-player': activePlayer===0}"
         class="player-card p-8 rounded-2xl shadow-xl bg-white/60 backdrop-blur-lg flex flex-col items-center gap-3 transition-all duration-300">
      <div class="flex items-center gap-2 mb-2">
        <p-avatar icon="pi pi-user" class="bg-pink-200 text-pink-600"></p-avatar>
        <span class="player-title text-base uppercase font-semibold text-pink-700">Player A</span>
      </div>
      <div class="timer text-7xl sm:text-8xl font-mono tracking-widest py-2 text-slate-900">{{formatSeconds(times[0])}}</div>
      <div class="flex gap-2 w-full justify-center mt-4">
        <button pButton type="button" (click)="pressButton(0)"
                [icon]="activePlayer===0 && running ? 'pi pi-exchange' : 'pi pi-play'"
                class="px-6 py-3 rounded-full font-medium transition">
          {{activePlayer===0 && running ? 'End Turn' : 'Start / Tap'}}
        </button>
        <button pButton type="button" (click)="addIncrement(0, 5)" icon="pi pi-plus" class="px-3 py-2 rounded-full">+5s</button>
      </div>
    </div>
    <!-- Player B -->
    <div [ngClass]="{'ring-4 ring-indigo-500 ring-offset-2 active-player': activePlayer===1}"
         class="player-card p-8 rounded-2xl shadow-xl bg-white/60 backdrop-blur-lg flex flex-col items-center gap-3 transition-all duration-300">
      <div class="flex items-center gap-2 mb-2">
        <p-avatar icon="pi pi-user" class="bg-indigo-200 text-indigo-700"></p-avatar>
        <span class="player-title text-base uppercase font-semibold text-indigo-700">Player B</span>
      </div>
      <div class="timer text-7xl sm:text-8xl font-mono tracking-widest py-2 text-slate-900">{{formatSeconds(times[1])}}</div>
      <div class="flex gap-2 w-full justify-center mt-4">
        <button pButton type="button" (click)="pressButton(1)"
                [icon]="activePlayer===1 && running ? 'pi pi-exchange' : 'pi pi-play'"
                class="px-6 py-3 rounded-full font-medium transition">
          {{activePlayer===1 && running ? 'End Turn' : 'Start / Tap'}}
        </button>
        <button pButton type="button" (click)="addIncrement(1, 5)" icon="pi pi-plus" class="px-3 py-2 rounded-full">+5s</button>
      </div>
    </div>
  </main>

  <!-- <footer class="w-full max-w-3xl mt-8 text-center text-sm text-gray-500">
    
  </footer> -->

  <!-- Hidden audio element for time's up -->
  <audio #alarmAudio>
    <source src="assets/sounds/tap-sound.mp3" />
  </audio>
